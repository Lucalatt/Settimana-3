package Esercizio1;

import java.beans.Statement;
import java.sql.Connection;
import java.sql.Date;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class DB {
		
		private final String url = "jdbc:postgresql://localhost:5432/Negozio?useSSL=false";
		private final String username = "postgres";
		private final String password = "1234";
		public static Connection conn = null;

		public void connect() {
			try {
			  System.out.println("Connecting to database " + url);
			  conn = DriverManager.getConnection(url, username, password);
			  System.out.println("Connection is successful!");
			}
			catch(Exception e) {
				e.printStackTrace();
			}
		}
		
		public void disconnect() {
			if( conn != null ) {    	  
			    try {
					  conn.close();
					  System.out.println("Disonnection is successful!");
				} catch (SQLException e) {
					  e.printStackTrace();
				}
			}
		}
		
		public void insertClient(String nome, String cognome, Date data_nascita,String regione_residenza) {
			
			try {
				String sql = "INSERT INTO students (nome, cognome, data_nascita, regione_residenza) VALUES (?, ?, ?, ?)";
				PreparedStatement stmt = conn.prepareStatement(sql);
				stmt.setString(1, nome);
				stmt.setString(2, cognome);
				stmt.setDate(3, data_nascita);
				stmt.setString(4, regione_residenza);
				stmt.execute();
				
				System.out.println("Insert is successful!");
			}
			catch(SQLException e) {
				System.out.println("There was an error during inserting data");
				e.printStackTrace();
			}
			
		}
}
